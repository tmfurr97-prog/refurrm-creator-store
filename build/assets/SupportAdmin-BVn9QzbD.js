import{r as n,j as e,ao as u,M as p}from"./react-vendor-zXfd7Ve7.js";import{s as r,C as l,a as o,b as i,c as d,B as j,j as g}from"./index-D8webL0o.js";import{B as f}from"./badge-C_-9dwWz.js";import"./vendor-BOHFvtXa.js";import"./ui-vendor-BrpyYz2q.js";import"./supabase-CH0YqYdn.js";function S(){const[m,x]=n.useState([]),[a,c]=n.useState(null);n.useEffect(()=>{t();const s=r.channel("conversations_changes").on("postgres_changes",{event:"*",schema:"public",table:"conversations"},t).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},t).subscribe();return()=>{r.removeChannel(s)}},[]);const t=async()=>{const{data:s}=await r.from("conversations").select("*").order("updated_at",{ascending:!1});s&&x(s)},h=async s=>{await r.from("conversations").update({status:"closed"}).eq("id",s),t(),a?.id===s&&c(null)};return e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Customer Support Dashboard"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(l,{className:"lg:col-span-1",children:[e.jsx(o,{children:e.jsx(i,{children:"Conversations"})}),e.jsx(d,{className:"space-y-2 max-h-[600px] overflow-y-auto",children:m.map(s=>e.jsxs("div",{onClick:()=>c(s),className:`p-3 rounded-lg cursor-pointer border ${a?.id===s.id?"bg-blue-50 border-blue-300":"hover:bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-sm",children:s.customer_name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.customer_email})]}),e.jsx(f,{variant:s.status==="open"?"default":"secondary",children:s.status})]}),e.jsxs("div",{className:"flex items-center gap-1 mt-2 text-xs text-gray-400",children:[e.jsx(u,{className:"h-3 w-3"}),new Date(s.created_at).toLocaleDateString()]})]},s.id))})]}),e.jsx(l,{className:"lg:col-span-2",children:a?e.jsxs(e.Fragment,{children:[e.jsxs(o,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(i,{children:a.customer_name}),e.jsx("p",{className:"text-sm text-gray-500",children:a.customer_email})]}),a.status==="open"&&e.jsx(j,{variant:"outline",onClick:()=>h(a.id),children:"Close"})]}),e.jsx(d,{className:"h-[500px]",children:e.jsx(g,{conversationId:a.id,senderType:"owner",senderName:"Support Team"})})]}):e.jsx("div",{className:"flex items-center justify-center h-[600px] text-gray-400",children:e.jsxs("div",{className:"text-center",children:[e.jsx(p,{className:"h-12 w-12 mx-auto mb-2"}),e.jsx("p",{children:"Select a conversation to start chatting"})]})})})]})]})}export{S as default};
//# sourceMappingURL=SupportAdmin-BVn9QzbD.js.map
