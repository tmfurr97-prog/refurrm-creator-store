{"version":3,"file":"Checkout-mRW6YnVU.js","sources":["../../src/pages/Checkout.tsx"],"sourcesContent":["import { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useCart } from '@/contexts/CartContext';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Card } from '@/components/ui/card';\nimport { supabase } from '@/lib/supabase';\nimport { useToast } from '@/hooks/use-toast';\n\nexport default function Checkout() {\n  const { cartItems, getCartTotal, clearCart } = useCart();\n  const navigate = useNavigate();\n  const { toast } = useToast();\n  const [loading, setLoading] = useState(false);\n  const [formData, setFormData] = useState({\n    email: '',\n    name: '',\n    address: '',\n    city: '',\n    state: '',\n    zip: '',\n    country: 'US'\n  });\n\n  const subtotal = getCartTotal();\n  const tax = subtotal * 0.08;\n  const shipping = 10.00;\n  const total = subtotal + tax + shipping;\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n\n    try {\n      // Get store owner from first product\n      const { data: product } = await supabase\n        .from('products')\n        .select('user_id')\n        .eq('id', cartItems[0].id)\n        .single();\n\n      const { data, error } = await supabase.functions.invoke('create-order-checkout', {\n        body: {\n          cartItems: cartItems.map(item => ({\n            id: item.id,\n            name: item.name,\n            price: item.price,\n            quantity: item.quantity\n          })),\n          storeOwnerId: product?.user_id,\n          customerEmail: formData.email,\n          customerName: formData.name,\n          shippingAddress: formData,\n          billingAddress: formData\n        }\n      });\n\n      if (error) throw error;\n\n      if (data.url) {\n        window.location.href = data.url;\n      }\n    } catch (error: any) {\n      toast({\n        title: 'Checkout Error',\n        description: error.message,\n        variant: 'destructive'\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (cartItems.length === 0) {\n    return (\n      <div className=\"container mx-auto px-4 py-16 text-center\">\n        <h1 className=\"text-2xl font-bold mb-4\">Your cart is empty</h1>\n        <Button onClick={() => navigate('/storefront')}>Continue Shopping</Button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"container mx-auto px-4 py-8\">\n      <h1 className=\"text-3xl font-bold mb-8\">Checkout</h1>\n      \n      <div className=\"grid md:grid-cols-2 gap-8\">\n        <Card className=\"p-6\">\n          <h2 className=\"text-xl font-semibold mb-4\">Shipping Information</h2>\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <Label>Email</Label>\n              <Input required type=\"email\" value={formData.email} \n                onChange={e => setFormData({...formData, email: e.target.value})} />\n            </div>\n            <div>\n              <Label>Full Name</Label>\n              <Input required value={formData.name} \n                onChange={e => setFormData({...formData, name: e.target.value})} />\n            </div>\n            <div>\n              <Label>Address</Label>\n              <Input required value={formData.address} \n                onChange={e => setFormData({...formData, address: e.target.value})} />\n            </div>\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <Label>City</Label>\n                <Input required value={formData.city} \n                  onChange={e => setFormData({...formData, city: e.target.value})} />\n              </div>\n              <div>\n                <Label>State</Label>\n                <Input required value={formData.state} \n                  onChange={e => setFormData({...formData, state: e.target.value})} />\n              </div>\n            </div>\n            <div>\n              <Label>ZIP Code</Label>\n              <Input required value={formData.zip} \n                onChange={e => setFormData({...formData, zip: e.target.value})} />\n            </div>\n            <Button type=\"submit\" className=\"w-full\" disabled={loading}>\n              {loading ? 'Processing...' : 'Proceed to Payment'}\n            </Button>\n          </form>\n        </Card>\n\n        <Card className=\"p-6 h-fit\">\n          <h2 className=\"text-xl font-semibold mb-4\">Order Summary</h2>\n          <div className=\"space-y-3 mb-4\">\n            {cartItems.map(item => (\n              <div key={item.id} className=\"flex justify-between text-sm\">\n                <span>{item.name} x {item.quantity}</span>\n                <span>${(item.price * item.quantity).toFixed(2)}</span>\n              </div>\n            ))}\n          </div>\n          <div className=\"border-t pt-3 space-y-2\">\n            <div className=\"flex justify-between\">\n              <span>Subtotal</span>\n              <span>${subtotal.toFixed(2)}</span>\n            </div>\n            <div className=\"flex justify-between\">\n              <span>Tax</span>\n              <span>${tax.toFixed(2)}</span>\n            </div>\n            <div className=\"flex justify-between\">\n              <span>Shipping</span>\n              <span>${shipping.toFixed(2)}</span>\n            </div>\n            <div className=\"flex justify-between font-bold text-lg border-t pt-2\">\n              <span>Total</span>\n              <span>${total.toFixed(2)}</span>\n            </div>\n          </div>\n        </Card>\n      </div>\n    </div>\n  );\n}\n"],"names":["Checkout","cartItems","getCartTotal","clearCart","useCart","navigate","useNavigate","toast","useToast","loading","setLoading","useState","formData","setFormData","subtotal","tax","shipping","total","handleSubmit","e","product","supabase","data","error","item","jsxs","jsx","Button","Card","Label","Input"],"mappings":"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"}