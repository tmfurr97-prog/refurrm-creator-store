import{q as w,r as j,j as e}from"./react-vendor-zXfd7Ve7.js";import{g as S,u as F,B as f,C as g,L as r,I as i,s as v}from"./index-D8webL0o.js";import"./vendor-BOHFvtXa.js";import"./ui-vendor-BrpyYz2q.js";import"./supabase-CH0YqYdn.js";function z(){const{cartItems:n,getCartTotal:y,clearCart:I}=S(),b=w(),{toast:N}=F(),[o,x]=j.useState(!1),[a,t]=j.useState({email:"",name:"",address:"",city:"",state:"",zip:"",country:"US"}),d=y(),u=d*.08,h=10,C=d+u+h,q=async s=>{s.preventDefault(),x(!0);try{const{data:c}=await v.from("products").select("user_id").eq("id",n[0].id).single(),{data:m,error:p}=await v.functions.invoke("create-order-checkout",{body:{cartItems:n.map(l=>({id:l.id,name:l.name,price:l.price,quantity:l.quantity})),storeOwnerId:c?.user_id,customerEmail:a.email,customerName:a.name,shippingAddress:a,billingAddress:a}});if(p)throw p;m.url&&(window.location.href=m.url)}catch(c){N({title:"Checkout Error",description:c.message,variant:"destructive"})}finally{x(!1)}};return n.length===0?e.jsxs("div",{className:"container mx-auto px-4 py-16 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Your cart is empty"}),e.jsx(f,{onClick:()=>b("/storefront"),children:"Continue Shopping"})]}):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Checkout"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsxs(g,{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Shipping Information"}),e.jsxs("form",{onSubmit:q,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Email"}),e.jsx(i,{required:!0,type:"email",value:a.email,onChange:s=>t({...a,email:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(r,{children:"Full Name"}),e.jsx(i,{required:!0,value:a.name,onChange:s=>t({...a,name:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(r,{children:"Address"}),e.jsx(i,{required:!0,value:a.address,onChange:s=>t({...a,address:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{children:"City"}),e.jsx(i,{required:!0,value:a.city,onChange:s=>t({...a,city:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(r,{children:"State"}),e.jsx(i,{required:!0,value:a.state,onChange:s=>t({...a,state:s.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(r,{children:"ZIP Code"}),e.jsx(i,{required:!0,value:a.zip,onChange:s=>t({...a,zip:s.target.value})})]}),e.jsx(f,{type:"submit",className:"w-full",disabled:o,children:o?"Processing...":"Proceed to Payment"})]})]}),e.jsxs(g,{className:"p-6 h-fit",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Order Summary"}),e.jsx("div",{className:"space-y-3 mb-4",children:n.map(s=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:[s.name," x ",s.quantity]}),e.jsxs("span",{children:["$",(s.price*s.quantity).toFixed(2)]})]},s.id))}),e.jsxs("div",{className:"border-t pt-3 space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:["$",d.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Tax"}),e.jsxs("span",{children:["$",u.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Shipping"}),e.jsxs("span",{children:["$",h.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between font-bold text-lg border-t pt-2",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["$",C.toFixed(2)]})]})]})]})]})]})}export{z as default};
//# sourceMappingURL=Checkout-mRW6YnVU.js.map
