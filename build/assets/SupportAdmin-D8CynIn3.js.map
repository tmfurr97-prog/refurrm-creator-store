{"version":3,"file":"SupportAdmin-D8CynIn3.js","sources":["../../src/pages/SupportAdmin.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { MessageSquare, Clock } from 'lucide-react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { ChatWindow } from '@/components/ChatWindow';\nimport { supabase } from '@/lib/supabase';\nimport { Button } from '@/components/ui/button';\n\ninterface Conversation {\n  id: string;\n  customer_name: string;\n  customer_email: string;\n  status: string;\n  created_at: string;\n  unread_count?: number;\n}\n\nexport default function SupportAdmin() {\n  const [conversations, setConversations] = useState<Conversation[]>([]);\n  const [selectedConv, setSelectedConv] = useState<Conversation | null>(null);\n\n  useEffect(() => {\n    loadConversations();\n    const channel = supabase\n      .channel('conversations_changes')\n      .on('postgres_changes', { event: '*', schema: 'public', table: 'conversations' }, loadConversations)\n      .on('postgres_changes', { event: 'INSERT', schema: 'public', table: 'messages' }, loadConversations)\n      .subscribe();\n\n    return () => { supabase.removeChannel(channel); };\n  }, []);\n\n  const loadConversations = async () => {\n    const { data } = await supabase.from('conversations').select('*').order('updated_at', { ascending: false });\n    if (data) setConversations(data);\n  };\n\n  const closeConversation = async (id: string) => {\n    await supabase.from('conversations').update({ status: 'closed' }).eq('id', id);\n    loadConversations();\n    if (selectedConv?.id === id) setSelectedConv(null);\n  };\n\n  return (\n    <div className=\"container mx-auto p-6\">\n      <h1 className=\"text-3xl font-bold mb-6\">Customer Support Dashboard</h1>\n      \n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        <Card className=\"lg:col-span-1\">\n          <CardHeader>\n            <CardTitle>Conversations</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-2 max-h-[600px] overflow-y-auto\">\n            {conversations.map(conv => (\n              <div\n                key={conv.id}\n                onClick={() => setSelectedConv(conv)}\n                className={`p-3 rounded-lg cursor-pointer border ${selectedConv?.id === conv.id ? 'bg-blue-50 border-blue-300' : 'hover:bg-gray-50'}`}\n              >\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex-1\">\n                    <p className=\"font-semibold text-sm\">{conv.customer_name}</p>\n                    <p className=\"text-xs text-gray-500\">{conv.customer_email}</p>\n                  </div>\n                  <Badge variant={conv.status === 'open' ? 'default' : 'secondary'}>{conv.status}</Badge>\n                </div>\n                <div className=\"flex items-center gap-1 mt-2 text-xs text-gray-400\">\n                  <Clock className=\"h-3 w-3\" />\n                  {new Date(conv.created_at).toLocaleDateString()}\n                </div>\n              </div>\n            ))}\n          </CardContent>\n        </Card>\n\n        <Card className=\"lg:col-span-2\">\n          {selectedConv ? (\n            <>\n              <CardHeader className=\"flex flex-row items-center justify-between\">\n                <div>\n                  <CardTitle>{selectedConv.customer_name}</CardTitle>\n                  <p className=\"text-sm text-gray-500\">{selectedConv.customer_email}</p>\n                </div>\n                {selectedConv.status === 'open' && (\n                  <Button variant=\"outline\" onClick={() => closeConversation(selectedConv.id)}>Close</Button>\n                )}\n              </CardHeader>\n              <CardContent className=\"h-[500px]\">\n                <ChatWindow conversationId={selectedConv.id} senderType=\"owner\" senderName=\"Support Team\" />\n              </CardContent>\n            </>\n          ) : (\n            <div className=\"flex items-center justify-center h-[600px] text-gray-400\">\n              <div className=\"text-center\">\n                <MessageSquare className=\"h-12 w-12 mx-auto mb-2\" />\n                <p>Select a conversation to start chatting</p>\n              </div>\n            </div>\n          )}\n        </Card>\n      </div>\n    </div>\n  );\n}\n"],"names":["SupportAdmin","conversations","setConversations","useState","selectedConv","setSelectedConv","useEffect","loadConversations","channel","supabase","data","closeConversation","id","jsxs","jsx","Card","CardHeader","CardTitle","CardContent","conv","Badge","Clock","Fragment","Button","ChatWindow","MessageSquare"],"mappings":"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"}