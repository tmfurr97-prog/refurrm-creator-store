import{a9 as p,r as o,j as e,p as n}from"./react-vendor-zXfd7Ve7.js";import{s as c}from"./index-D8webL0o.js";import"./vendor-BOHFvtXa.js";import"./ui-vendor-BrpyYz2q.js";import"./supabase-CH0YqYdn.js";function g(){const[i]=p(),r=i.get("order"),[s,m]=o.useState(null),[x,a]=o.useState(!0),[d,l]=o.useState(!1);o.useEffect(()=>{u()},[r]);const u=async()=>{if(!r){a(!1);return}const{data:t}=await c.from("orders").select("*, products(*), shops(*, profiles(*))").eq("id",r).single();m(t),a(!1)},h=async()=>{if(s?.download_token){l(!0);try{const t=s.products.file_url;await c.from("orders").update({download_count:(s.download_count||0)+1}).eq("id",s.id),window.open(t,"_blank")}catch(t){console.error("Download error:",t),alert("Failed to download. Please contact support.")}finally{l(!1)}}};return x?e.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:e.jsx("p",{className:"text-slate-600",children:"Loading..."})}):s?e.jsx("div",{className:"min-h-screen bg-[#EDDACE] py-12 px-4",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-[#1E8D70]/20 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx("svg",{className:"w-8 h-8 text-[#1E8D70]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h1",{className:"text-3xl font-bold text-[#5C4033] mb-4",children:"Thank you for your purchase!"}),e.jsxs("p",{className:"text-[#8B7355] mb-8",children:["Your order has been confirmed. A receipt has been sent to ",e.jsx("strong",{children:s.customer_email}),"."]}),e.jsxs("div",{className:"border-t border-[#C24C1A]/30 pt-6 mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-[#8B7355]",children:"Product:"}),e.jsx("span",{className:"font-semibold text-[#5C4033]",children:s.products.name})]}),e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-[#8B7355]",children:"Amount:"}),e.jsxs("span",{className:"font-semibold text-[#5C4033]",children:["$",s.amount]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-[#8B7355]",children:"Order ID:"}),e.jsx("span",{className:"font-mono text-sm text-[#8B7355]",children:s.id.slice(0,8)})]})]}),s.products.type==="digital"&&s.download_token&&e.jsxs("div",{className:"bg-[#1E8D70]/10 border border-[#C24C1A]/30 rounded-lg p-4 mb-6",children:[e.jsx("p",{className:"text-[#5C4033] mb-3",children:"Your download link has been sent to your email."}),e.jsx("button",{onClick:h,disabled:d,className:"px-6 py-3 bg-[#C24C1A] text-white rounded-lg font-semibold hover:bg-[#A63D14] transition disabled:opacity-50",children:d?"Downloading...":"Download Now"}),s.download_count>0&&e.jsxs("p",{className:"text-sm text-[#8B7355] mt-2",children:["Downloaded ",s.download_count," time",s.download_count!==1?"s":""]})]}),s.products.type==="course"&&e.jsxs("div",{className:"bg-[#1E8D70]/10 border border-[#C24C1A]/30 rounded-lg p-4 mb-6",children:[e.jsx("p",{className:"text-[#5C4033] mb-3",children:"You now have access to the course!"}),e.jsx(n,{to:`/course/${s.products.id}`,className:"inline-block px-6 py-3 bg-[#C24C1A] text-white rounded-lg font-semibold hover:bg-[#A63D14] transition",children:"Start Learning"})]}),s.products.type==="service"&&e.jsx("div",{className:"bg-[#1E8D70]/10 border border-[#C24C1A]/30 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-[#5C4033]",children:"Check your email for booking confirmation and next steps."})}),e.jsx(n,{to:`/store/${s.shops.profiles.username}`,className:"inline-block text-[#C24C1A] hover:underline mt-4",children:"Back to store"})]})})}):e.jsx("div",{className:"min-h-screen bg-[#EDDACE] flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-[#5C4033] mb-4",children:"Order not found"}),e.jsx(n,{to:"/",className:"text-[#C24C1A] hover:underline",children:"Go to homepage"})]})})}export{g as default};
//# sourceMappingURL=Success-CMCrmeAb.js.map
