import{r as a,j as e,x as v,bd as L}from"./react-vendor-zXfd7Ve7.js";import{s as i,C as N,L as t,I as r,B as m}from"./index-k1V3dZSG.js";import{S as z,a as D,b as H,c as O,d as R}from"./select-C3Vw_1bu.js";import{S as q}from"./switch-IuCVSr7H.js";import{G as T}from"./vendor-BOHFvtXa.js";import{T as G,a as U,b as _,c as n,d as $,e as l}from"./table-Cg8Ddt1f.js";import"./ui-vendor-BrpyYz2q.js";import"./supabase-CH0YqYdn.js";function Y(){const[w,y]=a.useState([]),[B,k]=a.useState([]),[o,x]=a.useState(""),[h,j]=a.useState(""),[u,p]=a.useState(""),[c,g]=a.useState(!1),[b,C]=a.useState(""),[S,f]=a.useState("");a.useEffect(()=>{d(),A()},[]);const d=async()=>{const{data:s}=await i.from("email_campaigns").select("*, email_templates(name)").order("created_at",{ascending:!1});y(s||[])},A=async()=>{const{data:s}=await i.from("email_templates").select("*");k(s||[])},E=async()=>{const{data:{user:s}}=await i.auth.getUser();if(!s)return;const V={user_id:s.id,name:o,subject:h,template_id:u,ab_test_enabled:c,variant_b_subject:c?b:null,scheduled_at:S||null,status:"draft"};await i.from("email_campaigns").insert(V),T.success("Campaign created"),x(""),j(""),p(""),g(!1),C(""),f(""),d()},I=async s=>{await i.from("email_campaigns").update({status:"sent",sent_at:new Date().toISOString()}).eq("id",s),T.success("Campaign sent"),d()};return e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Email Campaigns"}),e.jsxs(N,{className:"p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Create Campaign"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{children:"Campaign Name"}),e.jsx(r,{value:o,onChange:s=>x(s.target.value)})]}),e.jsxs("div",{children:[e.jsx(t,{children:"Template"}),e.jsxs(z,{value:u,onValueChange:p,children:[e.jsx(D,{children:e.jsx(H,{placeholder:"Select template"})}),e.jsx(O,{children:B.map(s=>e.jsx(R,{value:s.id,children:s.name},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(t,{children:"Subject Line"}),e.jsx(r,{value:h,onChange:s=>j(s.target.value)})]}),e.jsxs("div",{children:[e.jsx(t,{children:"Schedule (optional)"}),e.jsx(r,{type:"datetime-local",value:S,onChange:s=>f(s.target.value)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{checked:c,onCheckedChange:g}),e.jsx(t,{children:"Enable A/B Testing"})]}),c&&e.jsxs("div",{children:[e.jsx(t,{children:"Variant B Subject"}),e.jsx(r,{value:b,onChange:s=>C(s.target.value)})]})]}),e.jsxs(m,{onClick:E,className:"mt-4",children:[e.jsx(v,{className:"h-4 w-4 mr-2"}),"Create Campaign"]})]}),e.jsxs(N,{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"All Campaigns"}),e.jsxs(G,{children:[e.jsx(U,{children:e.jsxs(_,{children:[e.jsx(n,{children:"Name"}),e.jsx(n,{children:"Subject"}),e.jsx(n,{children:"Status"}),e.jsx(n,{children:"Opens"}),e.jsx(n,{children:"Clicks"}),e.jsx(n,{children:"Actions"})]})}),e.jsx($,{children:w.map(s=>e.jsxs(_,{children:[e.jsx(l,{children:s.name}),e.jsx(l,{children:s.subject}),e.jsx(l,{children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.status==="sent"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:s.status})}),e.jsx(l,{children:s.opens}),e.jsx(l,{children:s.clicks}),e.jsxs(l,{className:"flex gap-2",children:[s.status==="draft"&&e.jsxs(m,{size:"sm",onClick:()=>I(s.id),children:[e.jsx(v,{className:"h-4 w-4 mr-1"}),"Send"]}),e.jsx(m,{size:"sm",variant:"outline",children:e.jsx(L,{className:"h-4 w-4"})})]})]},s.id))})]})]})]})}export{Y as default};
//# sourceMappingURL=EmailCampaigns-BqTsqk6p.js.map
