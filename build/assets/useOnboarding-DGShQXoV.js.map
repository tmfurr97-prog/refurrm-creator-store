{"version":3,"file":"useOnboarding-DGShQXoV.js","sources":["../../src/hooks/useOnboarding.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { supabase } from '@/lib/supabase';\nimport { useAuth } from '@/contexts/AuthContext';\n\nexport interface OnboardingProgress {\n  current_step: number;\n  completed_steps: number[];\n  skipped_steps: number[];\n  is_completed: boolean;\n}\n\nexport const useOnboarding = () => {\n  const { user } = useAuth();\n  const [progress, setProgress] = useState<OnboardingProgress | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  const fetchProgress = async () => {\n    if (!user) return;\n    \n    const { data, error } = await supabase\n      .from('user_profiles')\n      .select('onboarding_step, onboarding_completed')\n      .eq('id', user.id)\n      .single();\n\n    if (error) {\n      console.error('Error fetching onboarding:', error);\n    } else if (data) {\n      setProgress({\n        current_step: data.onboarding_step || 0,\n        completed_steps: [],\n        skipped_steps: [],\n        is_completed: data.onboarding_completed || false\n      });\n    }\n    \n    setLoading(false);\n  };\n\n  useEffect(() => {\n    fetchProgress();\n  }, [user]);\n\n  const startOnboarding = async () => {\n    if (!user) return;\n\n    const { error } = await supabase\n      .from('user_profiles')\n      .update({ onboarding_step: 1 })\n      .eq('id', user.id);\n\n    if (!error) fetchProgress();\n  };\n\n  const updateStep = async (step: number) => {\n    if (!user) return;\n\n    const { error } = await supabase\n      .from('user_profiles')\n      .update({ onboarding_step: step })\n      .eq('id', user.id);\n\n    if (!error) fetchProgress();\n  };\n\n  const completeOnboarding = async () => {\n    if (!user) return;\n\n    const { error } = await supabase\n      .from('user_profiles')\n      .update({ \n        onboarding_completed: true,\n        onboarding_step: 5\n      })\n      .eq('id', user.id);\n\n    if (!error) fetchProgress();\n  };\n\n  return {\n    progress,\n    loading,\n    startOnboarding,\n    updateStep,\n    completeOnboarding,\n    needsOnboarding: !loading && user && progress && !progress.is_completed\n  };\n};\n"],"names":["useOnboarding","user","useAuth","progress","setProgress","useState","loading","setLoading","fetchProgress","data","error","supabase","useEffect","step"],"mappings":"8FAWO,MAAMA,EAAgB,IAAM,CACjC,KAAM,CAAE,KAAAC,CAAA,EAASC,EAAA,EACX,CAACC,EAAUC,CAAW,EAAIC,EAAAA,SAAoC,IAAI,EAClE,CAACC,EAASC,CAAU,EAAIF,EAAAA,SAAS,EAAI,EAErCG,EAAgB,SAAY,CAChC,GAAI,CAACP,EAAM,OAEX,KAAM,CAAE,KAAAQ,EAAM,MAAAC,CAAA,EAAU,MAAMC,EAC3B,KAAK,eAAe,EACpB,OAAO,uCAAuC,EAC9C,GAAG,KAAMV,EAAK,EAAE,EAChB,OAAA,EAECS,EACF,QAAQ,MAAM,6BAA8BA,CAAK,EACxCD,GACTL,EAAY,CACV,aAAcK,EAAK,iBAAmB,EACtC,gBAAiB,CAAA,EACjB,cAAe,CAAA,EACf,aAAcA,EAAK,sBAAwB,EAAA,CAC5C,EAGHF,EAAW,EAAK,CAClB,EAEAK,OAAAA,EAAAA,UAAU,IAAM,CACdJ,EAAA,CACF,EAAG,CAACP,CAAI,CAAC,EAsCF,CACL,SAAAE,EACA,QAAAG,EACA,gBAvCsB,SAAY,CAClC,GAAI,CAACL,EAAM,OAEX,KAAM,CAAE,MAAAS,CAAA,EAAU,MAAMC,EACrB,KAAK,eAAe,EACpB,OAAO,CAAE,gBAAiB,CAAA,CAAG,EAC7B,GAAG,KAAMV,EAAK,EAAE,EAEdS,GAAOF,EAAA,CACd,EA+BE,WA7BiB,MAAOK,GAAiB,CACzC,GAAI,CAACZ,EAAM,OAEX,KAAM,CAAE,MAAAS,CAAA,EAAU,MAAMC,EACrB,KAAK,eAAe,EACpB,OAAO,CAAE,gBAAiBE,CAAA,CAAM,EAChC,GAAG,KAAMZ,EAAK,EAAE,EAEdS,GAAOF,EAAA,CACd,EAqBE,mBAnByB,SAAY,CACrC,GAAI,CAACP,EAAM,OAEX,KAAM,CAAE,MAAAS,GAAU,MAAMC,EACrB,KAAK,eAAe,EACpB,OAAO,CACN,qBAAsB,GACtB,gBAAiB,CAAA,CAClB,EACA,GAAG,KAAMV,EAAK,EAAE,EAEdS,GAAOF,EAAA,CACd,EAQE,gBAAiB,CAACF,GAAWL,GAAQE,GAAY,CAACA,EAAS,YAAA,CAE/D"}