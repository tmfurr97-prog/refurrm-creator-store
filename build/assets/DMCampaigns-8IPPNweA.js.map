{"version":3,"file":"DMCampaigns-8IPPNweA.js","sources":["../../src/pages/DMCampaigns.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { supabase } from '@/lib/supabase';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Badge } from '@/components/ui/badge';\nimport DashboardNav from '@/components/DashboardNav';\n\nexport default function DMCampaigns() {\n  const { user } = useAuth();\n  const [campaigns, setCampaigns] = useState<any[]>([]);\n  const [products, setProducts] = useState<any[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [showCreate, setShowCreate] = useState(false);\n  \n  const [form, setForm] = useState({\n    name: '',\n    goal: '',\n    keyword: '',\n    product_id: ''\n  });\n\n  useEffect(() => {\n    loadData();\n  }, [user]);\n\n  const loadData = async () => {\n    if (!user) return;\n\n    const { data: shopData } = await supabase\n      .from('shops')\n      .select('id')\n      .eq('user_id', user.id)\n      .single();\n\n    if (shopData) {\n      const { data: campaignsData } = await supabase\n        .from('dm_campaigns')\n        .select('*, products(name)')\n        .eq('shop_id', shopData.id)\n        .order('created_at', { ascending: false });\n\n      setCampaigns(campaignsData || []);\n\n      const { data: productsData } = await supabase\n        .from('products')\n        .select('*')\n        .eq('shop_id', shopData.id);\n\n      setProducts(productsData || []);\n    }\n\n    setLoading(false);\n  };\n\n  const createCampaign = async () => {\n    if (!form.name || !form.keyword) {\n      alert('Please fill in campaign name and keyword');\n      return;\n    }\n\n    const { data: shopData } = await supabase\n      .from('shops')\n      .select('id')\n      .eq('user_id', user?.id)\n      .single();\n\n    if (shopData) {\n      await supabase.from('dm_campaigns').insert({\n        shop_id: shopData.id,\n        name: form.name,\n        goal: form.goal,\n        keyword: form.keyword.toUpperCase(),\n        product_id: form.product_id || null,\n        dm_sequence: [\n          { order: 1, message: `Thanks for your interest! Here's the link to ${form.name}` }\n        ],\n        suggested_caption: `Comment \"${form.keyword.toUpperCase()}\" below to get instant access!`\n      });\n\n      setForm({ name: '', goal: '', keyword: '', product_id: '' });\n      setShowCreate(false);\n      loadData();\n    }\n  };\n\n  return (\n    <div className=\"flex min-h-screen bg-slate-50\">\n      <DashboardNav />\n      \n      <div className=\"flex-1 p-8\">\n        <div className=\"max-w-6xl mx-auto\">\n          <div className=\"flex justify-between items-center mb-8\">\n            <CardTitle className=\"text-3xl\">DM Campaigns</CardTitle>\n            <Button\n              onClick={() => setShowCreate(!showCreate)}\n            >\n              {showCreate ? 'Cancel' : 'Create Campaign'}\n            </Button>\n          </div>\n\n          <Card className=\"bg-blue-50 border-blue-200 mb-6\">\n            <CardContent className=\"p-4\">\n              <p className=\"text-blue-900 text-sm\">\n                <strong>Note:</strong> Live Instagram automation requires connecting your Instagram business account. \n                For now, you can create campaigns and copy the scripts manually.\n              </p>\n            </CardContent>\n          </Card>\n\n          {showCreate && (\n            <Card className=\"mb-6\">\n              <CardHeader>\n                <CardTitle>Create DM Campaign</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-4\">\n                  <div>\n                    <Label>Campaign Name</Label>\n                    <Input\n                      type=\"text\"\n                      value={form.name}\n                      onChange={(e) => setForm({ ...form, name: e.target.value })}\n                      placeholder=\"e.g., Budget Course Promo\"\n                    />\n                  </div>\n                  <div>\n                    <Label>Keyword</Label>\n                    <Input\n                      type=\"text\"\n                      value={form.keyword}\n                      onChange={(e) => setForm({ ...form, keyword: e.target.value })}\n                      placeholder=\"e.g., BUDGET\"\n                    />\n                  </div>\n                  <div>\n                    <Label>Link to Product (Optional)</Label>\n                    <Select\n                      value={form.product_id}\n                      onValueChange={(value) => setForm({ ...form, product_id: value })}\n                    >\n                      <SelectTrigger>\n                        <SelectValue placeholder=\"None\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"\">None</SelectItem>\n                        {products.map(p => (\n                          <SelectItem key={p.id} value={p.id}>{p.name}</SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  <div>\n                    <Label>Goal (Optional)</Label>\n                    <Textarea\n                      value={form.goal}\n                      onChange={(e) => setForm({ ...form, goal: e.target.value })}\n                      placeholder=\"What do you want to achieve with this campaign?\"\n                    />\n                  </div>\n                  <Button\n                    onClick={createCampaign}\n                  >\n                    Create Campaign\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          {loading ? (\n            <p className=\"text-slate-600\">Loading campaigns...</p>\n          ) : campaigns.length === 0 ? (\n            <Card>\n              <CardContent className=\"p-12 text-center\">\n                <p className=\"text-slate-600\">No DM campaigns yet. Create one to get started!</p>\n              </CardContent>\n            </Card>\n          ) : (\n            <div className=\"space-y-4\">\n              {campaigns.map(campaign => (\n                <Card key={campaign.id}>\n                  <CardHeader>\n                    <div className=\"flex justify-between items-start\">\n                      <div>\n                        <CardTitle>{campaign.name}</CardTitle>\n                        <p className=\"text-sm text-slate-600 mt-1\">Keyword: <strong>{campaign.keyword}</strong></p>\n                        {campaign.products && (\n                          <p className=\"text-sm text-slate-600\">Linked to: {campaign.products.name}</p>\n                        )}\n                      </div>\n                      <Badge variant={campaign.active ? 'default' : 'secondary'}>\n                        {campaign.active ? 'Active' : 'Draft'}\n                      </Badge>\n                    </div>\n                  </CardHeader>\n                  \n                  {campaign.suggested_caption && (\n                    <CardContent>\n                      <div className=\"p-3 bg-purple-50 rounded\">\n                        <p className=\"text-sm font-medium text-purple-900 mb-1\">Suggested Caption:</p>\n                        <p className=\"text-sm text-purple-700\">{campaign.suggested_caption}</p>\n                      </div>\n                    </CardContent>\n                  )}\n                </Card>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":["DMCampaigns","user","useAuth","campaigns","setCampaigns","useState","products","setProducts","loading","setLoading","showCreate","setShowCreate","form","setForm","useEffect","loadData","shopData","supabase","campaignsData","productsData","createCampaign","jsxs","jsx","DashboardNav","CardTitle","Button","Card","CardContent","CardHeader","Label","Input","e","Select","value","SelectTrigger","SelectValue","SelectContent","SelectItem","p","Textarea","campaign","Badge"],"mappings":"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"}