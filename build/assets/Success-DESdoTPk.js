import{a9 as h,r,j as e,p as a}from"./react-vendor-zXfd7Ve7.js";import{s as c}from"./index-k1V3dZSG.js";import"./vendor-BOHFvtXa.js";import"./ui-vendor-BrpyYz2q.js";import"./supabase-CH0YqYdn.js";function N(){const[i]=h(),o=i.get("order"),[s,m]=r.useState(null),[p,n]=r.useState(!0),[l,d]=r.useState(!1);r.useEffect(()=>{u()},[o]);const u=async()=>{if(!o){n(!1);return}const{data:t}=await c.from("orders").select("*, products(*), shops(*, profiles(*))").eq("id",o).single();m(t),n(!1)},x=async()=>{if(s?.download_token){d(!0);try{const t=s.products.file_url;await c.from("orders").update({download_count:(s.download_count||0)+1}).eq("id",s.id),window.open(t,"_blank")}catch(t){console.error("Download error:",t),alert("Failed to download. Please contact support.")}finally{d(!1)}}};return p?e.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:e.jsx("p",{className:"text-slate-600",children:"Loading..."})}):s?e.jsx("div",{className:"min-h-screen bg-slate-50 py-12 px-4",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-4",children:"Thank you for your purchase!"}),e.jsxs("p",{className:"text-slate-600 mb-8",children:["Your order has been confirmed. A receipt has been sent to ",e.jsx("strong",{children:s.customer_email}),"."]}),e.jsxs("div",{className:"border-t border-slate-200 pt-6 mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-slate-600",children:"Product:"}),e.jsx("span",{className:"font-semibold text-slate-900",children:s.products.name})]}),e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-slate-600",children:"Amount:"}),e.jsxs("span",{className:"font-semibold text-slate-900",children:["$",s.amount]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-600",children:"Order ID:"}),e.jsx("span",{className:"font-mono text-sm text-slate-600",children:s.id.slice(0,8)})]})]}),s.products.type==="digital"&&s.download_token&&e.jsxs("div",{className:"bg-pale skin-50 border border-pale skin-200 rounded-lg p-4 mb-6",children:[e.jsx("p",{className:"text-pale skin-900 mb-3",children:"Your download link has been sent to your email."}),e.jsx("button",{onClick:x,disabled:l,className:"px-6 py-3 bg-pale skin-600 text-white rounded-lg font-semibold hover:bg-pale skin-700 transition disabled:opacity-50",children:l?"Downloading...":"Download Now"}),s.download_count>0&&e.jsxs("p",{className:"text-sm text-slate-600 mt-2",children:["Downloaded ",s.download_count," time",s.download_count!==1?"s":""]})]}),s.products.type==="course"&&e.jsxs("div",{className:"bg-pale skin-50 border border-pale skin-200 rounded-lg p-4 mb-6",children:[e.jsx("p",{className:"text-pale skin-900 mb-3",children:"You now have access to the course!"}),e.jsx(a,{to:`/course/${s.products.id}`,className:"inline-block px-6 py-3 bg-pale skin-600 text-white rounded-lg font-semibold hover:bg-pale skin-700 transition",children:"Start Learning"})]}),s.products.type==="service"&&e.jsx("div",{className:"bg-pale skin-50 border border-pale skin-200 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-pale skin-900",children:"Check your email for booking confirmation and next steps."})}),e.jsx(a,{to:`/store/${s.shops.profiles.username}`,className:"inline-block text-pale skin-600 hover:underline mt-4",children:"Back to store"})]})})}):e.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-slate-600 mb-4",children:"Order not found"}),e.jsx(a,{to:"/",className:"text-pale skin-600 hover:underline",children:"Go to homepage"})]})})}export{N as default};
//# sourceMappingURL=Success-DESdoTPk.js.map
