{"version":3,"file":"Collections-DczROMlA.js","sources":["../../src/components/CollectionEditor.tsx","../../src/pages/Collections.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { supabase } from '@/lib/supabase';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Card } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Sparkles, Save, Trash2, GripVertical } from 'lucide-react';\nimport { toast } from 'sonner';\n\ninterface Collection {\n  id: string;\n  name: string;\n  description: string;\n  seo_title: string;\n  seo_description: string;\n  theme: string;\n  is_published: boolean;\n}\n\nexport function CollectionEditor() {\n  const [collections, setCollections] = useState<Collection[]>([]);\n  const [selectedCollection, setSelectedCollection] = useState<Collection | null>(null);\n  const [products, setProducts] = useState<any[]>([]);\n  const [collectionProducts, setCollectionProducts] = useState<any[]>([]);\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    loadCollections();\n    loadProducts();\n  }, []);\n\n  const loadCollections = async () => {\n    const { data } = await supabase.from('collections').select('*').order('created_at', { ascending: false });\n    if (data) setCollections(data);\n  };\n\n  const loadProducts = async () => {\n    const { data } = await supabase.from('products').select('*');\n    if (data) setProducts(data);\n  };\n\n  const generateAICollections = async () => {\n    setLoading(true);\n    try {\n      const { data, error } = await supabase.functions.invoke('ai-collection-organizer', {\n        body: { products }\n      });\n      if (error) throw error;\n      toast.success('AI collections generated!');\n      loadCollections();\n    } catch (error: any) {\n      toast.error(error.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const saveCollection = async () => {\n    if (!selectedCollection) return;\n    const { error } = await supabase.from('collections').upsert(selectedCollection);\n    if (error) {\n      toast.error(error.message);\n    } else {\n      toast.success('Collection saved!');\n      loadCollections();\n    }\n  };\n\n  const deleteCollection = async (id: string) => {\n    const { error } = await supabase.from('collections').delete().eq('id', id);\n    if (error) {\n      toast.error(error.message);\n    } else {\n      toast.success('Collection deleted!');\n      loadCollections();\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex justify-between items-center\">\n        <h2 className=\"text-2xl font-bold\">Collection Manager</h2>\n        <Button onClick={generateAICollections} disabled={loading}>\n          <Sparkles className=\"w-4 h-4 mr-2\" />\n          Generate AI Collections\n        </Button>\n      </div>\n\n      <div className=\"grid md:grid-cols-3 gap-6\">\n        <div className=\"space-y-4\">\n          {collections.map((col) => (\n            <Card key={col.id} className=\"p-4 cursor-pointer hover:border-primary\" onClick={() => setSelectedCollection(col)}>\n              <div className=\"flex justify-between items-start\">\n                <div>\n                  <h3 className=\"font-semibold\">{col.name}</h3>\n                  <p className=\"text-sm text-muted-foreground\">{col.theme}</p>\n                </div>\n                <Button variant=\"ghost\" size=\"sm\" onClick={(e) => { e.stopPropagation(); deleteCollection(col.id); }}>\n                  <Trash2 className=\"w-4 h-4\" />\n                </Button>\n              </div>\n            </Card>\n          ))}\n        </div>\n\n        {selectedCollection && (\n          <div className=\"md:col-span-2 space-y-4\">\n            <Card className=\"p-6\">\n              <Input value={selectedCollection.name} onChange={(e) => setSelectedCollection({ ...selectedCollection, name: e.target.value })} placeholder=\"Collection Name\" className=\"mb-4\" />\n              <Textarea value={selectedCollection.description} onChange={(e) => setSelectedCollection({ ...selectedCollection, description: e.target.value })} placeholder=\"Description\" className=\"mb-4\" />\n              <Input value={selectedCollection.seo_title} onChange={(e) => setSelectedCollection({ ...selectedCollection, seo_title: e.target.value })} placeholder=\"SEO Title\" className=\"mb-4\" />\n              <Textarea value={selectedCollection.seo_description} onChange={(e) => setSelectedCollection({ ...selectedCollection, seo_description: e.target.value })} placeholder=\"SEO Description\" className=\"mb-4\" />\n              <Button onClick={saveCollection}>\n                <Save className=\"w-4 h-4 mr-2\" />\n                Save Collection\n              </Button>\n            </Card>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","import { useAuth } from '@/contexts/AuthContext';\nimport DashboardNav from '@/components/DashboardNav';\nimport { CollectionEditor } from '@/components/CollectionEditor';\n\nexport default function Collections() {\n  const { user } = useAuth();\n\n  if (!user) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <p className=\"text-lg\">Please log in to manage collections.</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex min-h-screen bg-slate-50\">\n      <DashboardNav />\n      \n      <div className=\"flex-1 p-8\">\n        <div className=\"max-w-7xl mx-auto\">\n          <CollectionEditor />\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":["CollectionEditor","collections","setCollections","useState","selectedCollection","setSelectedCollection","products","setProducts","collectionProducts","setCollectionProducts","loading","setLoading","useEffect","loadCollections","loadProducts","data","supabase","generateAICollections","error","toast","saveCollection","deleteCollection","id","jsxs","jsx","Button","Sparkles","col","Card","e","Trash2","Input","Textarea","Save","Collections","user","useAuth","DashboardNav"],"mappings":"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"}