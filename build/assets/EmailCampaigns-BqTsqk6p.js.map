{"version":3,"file":"EmailCampaigns-BqTsqk6p.js","sources":["../../src/pages/EmailCampaigns.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { supabase } from '@/lib/supabase';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Card } from '@/components/ui/card';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Switch } from '@/components/ui/switch';\nimport { toast } from 'sonner';\nimport { Send, Calendar, BarChart3 } from 'lucide-react';\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\n\nexport default function EmailCampaigns() {\n  const [campaigns, setCampaigns] = useState<any[]>([]);\n  const [templates, setTemplates] = useState<any[]>([]);\n  const [name, setName] = useState('');\n  const [subject, setSubject] = useState('');\n  const [templateId, setTemplateId] = useState('');\n  const [abTest, setAbTest] = useState(false);\n  const [variantB, setVariantB] = useState('');\n  const [scheduledAt, setScheduledAt] = useState('');\n\n  useEffect(() => {\n    loadCampaigns();\n    loadTemplates();\n  }, []);\n\n  const loadCampaigns = async () => {\n    const { data } = await supabase.from('email_campaigns').select('*, email_templates(name)').order('created_at', { ascending: false });\n    setCampaigns(data || []);\n  };\n\n  const loadTemplates = async () => {\n    const { data } = await supabase.from('email_templates').select('*');\n    setTemplates(data || []);\n  };\n\n  const handleCreate = async () => {\n    const { data: { user } } = await supabase.auth.getUser();\n    if (!user) return;\n\n    const campaignData = {\n      user_id: user.id,\n      name,\n      subject,\n      template_id: templateId,\n      ab_test_enabled: abTest,\n      variant_b_subject: abTest ? variantB : null,\n      scheduled_at: scheduledAt || null,\n      status: 'draft'\n    };\n\n    await supabase.from('email_campaigns').insert(campaignData);\n    toast.success('Campaign created');\n    setName('');\n    setSubject('');\n    setTemplateId('');\n    setAbTest(false);\n    setVariantB('');\n    setScheduledAt('');\n    loadCampaigns();\n  };\n\n  const handleSend = async (id: string) => {\n    await supabase.from('email_campaigns').update({ status: 'sent', sent_at: new Date().toISOString() }).eq('id', id);\n    toast.success('Campaign sent');\n    loadCampaigns();\n  };\n\n  return (\n    <div className=\"container mx-auto p-6\">\n      <h1 className=\"text-3xl font-bold mb-6\">Email Campaigns</h1>\n\n      <Card className=\"p-6 mb-6\">\n        <h2 className=\"text-xl font-bold mb-4\">Create Campaign</h2>\n        <div className=\"grid md:grid-cols-2 gap-4\">\n          <div><Label>Campaign Name</Label><Input value={name} onChange={(e) => setName(e.target.value)} /></div>\n          <div><Label>Template</Label><Select value={templateId} onValueChange={setTemplateId}><SelectTrigger><SelectValue placeholder=\"Select template\" /></SelectTrigger><SelectContent>{templates.map(t => <SelectItem key={t.id} value={t.id}>{t.name}</SelectItem>)}</SelectContent></Select></div>\n          <div><Label>Subject Line</Label><Input value={subject} onChange={(e) => setSubject(e.target.value)} /></div>\n          <div><Label>Schedule (optional)</Label><Input type=\"datetime-local\" value={scheduledAt} onChange={(e) => setScheduledAt(e.target.value)} /></div>\n          <div className=\"flex items-center gap-2\"><Switch checked={abTest} onCheckedChange={setAbTest} /><Label>Enable A/B Testing</Label></div>\n          {abTest && <div><Label>Variant B Subject</Label><Input value={variantB} onChange={(e) => setVariantB(e.target.value)} /></div>}\n        </div>\n        <Button onClick={handleCreate} className=\"mt-4\"><Send className=\"h-4 w-4 mr-2\" />Create Campaign</Button>\n      </Card>\n\n      <Card className=\"p-6\">\n        <h2 className=\"text-xl font-bold mb-4\">All Campaigns</h2>\n        <Table>\n          <TableHeader><TableRow><TableHead>Name</TableHead><TableHead>Subject</TableHead><TableHead>Status</TableHead><TableHead>Opens</TableHead><TableHead>Clicks</TableHead><TableHead>Actions</TableHead></TableRow></TableHeader>\n          <TableBody>\n            {campaigns.map(c => (\n              <TableRow key={c.id}>\n                <TableCell>{c.name}</TableCell>\n                <TableCell>{c.subject}</TableCell>\n                <TableCell><span className={`px-2 py-1 rounded text-xs ${c.status === 'sent' ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'}`}>{c.status}</span></TableCell>\n                <TableCell>{c.opens}</TableCell>\n                <TableCell>{c.clicks}</TableCell>\n                <TableCell className=\"flex gap-2\">\n                  {c.status === 'draft' && <Button size=\"sm\" onClick={() => handleSend(c.id)}><Send className=\"h-4 w-4 mr-1\" />Send</Button>}\n                  <Button size=\"sm\" variant=\"outline\"><BarChart3 className=\"h-4 w-4\" /></Button>\n                </TableCell>\n              </TableRow>\n            ))}\n          </TableBody>\n        </Table>\n      </Card>\n    </div>\n  );\n}\n"],"names":["EmailCampaigns","campaigns","setCampaigns","useState","templates","setTemplates","name","setName","subject","setSubject","templateId","setTemplateId","abTest","setAbTest","variantB","setVariantB","scheduledAt","setScheduledAt","useEffect","loadCampaigns","loadTemplates","data","supabase","handleCreate","user","campaignData","toast","handleSend","id","jsxs","jsx","Card","Label","Input","e","Select","SelectTrigger","SelectValue","SelectContent","SelectItem","t","Switch","Button","Send","Table","TableHeader","TableRow","TableHead","TableBody","c","TableCell","BarChart3"],"mappings":"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"}