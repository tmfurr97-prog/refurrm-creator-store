import{j as e,H as D,ag as S,ae as T,$ as P,l as X,q as ee,m as h,r as d,an as B,O as se,ao as A,p as ae,ap as te,aq as _,ar as ie,as as re,at as le,au as E,av as V,aw as I,ax as L,ay as M,az as R,a8 as ne,a0 as ce,ai as de}from"./react-vendor-zXfd7Ve7.js";import{C as n,a as o,b as m,c,B as j,d as v,u as H,f as u,i as Y,s as C}from"./index-k1V3dZSG.js";import{B as x}from"./badge-wcb6nnAT.js";import{D as U}from"./DashboardNav-dXlKSIlC.js";import{P as $}from"./progress-DEvZflFE.js";import{T as oe,a as me,b as k,c as b,d as xe,e as y}from"./table-Cg8Ddt1f.js";import"./vendor-BOHFvtXa.js";import"./ui-vendor-BrpyYz2q.js";import"./supabase-CH0YqYdn.js";function ue({planTier:s}){const a=s==="pro"?[{label:"Products",current:45,limit:100,icon:D},{label:"Customers",current:234,limit:1e3,icon:S},{label:"Emails Sent",current:1250,limit:5e3,icon:T},{label:"Bookings",current:18,limit:50,icon:P}]:[{label:"Products",current:8,limit:10,icon:D},{label:"Customers",current:45,limit:100,icon:S},{label:"Emails Sent",current:320,limit:500,icon:T},{label:"Bookings",current:7,limit:10,icon:P}];return e.jsxs(n,{children:[e.jsx(o,{children:e.jsx(m,{children:"Usage Limits"})}),e.jsx(c,{className:"space-y-6",children:a.map(t=>{const r=t.current/t.limit*100,i=t.icon;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"font-medium",children:t.label})]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[t.current," / ",t.limit]})]}),e.jsx($,{value:r,className:"h-2"})]},t.label)})})]})}function pe(){const s=[{id:"INV-001",date:"2024-11-01",amount:29,status:"paid",invoiceUrl:"#"},{id:"INV-002",date:"2024-10-01",amount:29,status:"paid",invoiceUrl:"#"},{id:"INV-003",date:"2024-09-01",amount:29,status:"paid",invoiceUrl:"#"},{id:"INV-004",date:"2024-08-01",amount:29,status:"paid",invoiceUrl:"#"}];return e.jsxs(n,{children:[e.jsx(o,{children:e.jsx(m,{children:"Billing History"})}),e.jsx(c,{children:e.jsxs(oe,{children:[e.jsx(me,{children:e.jsxs(k,{children:[e.jsx(b,{children:"Invoice"}),e.jsx(b,{children:"Date"}),e.jsx(b,{children:"Amount"}),e.jsx(b,{children:"Status"}),e.jsx(b,{children:"Action"})]})}),e.jsx(xe,{children:s.map(a=>e.jsxs(k,{children:[e.jsx(y,{className:"font-medium",children:a.id}),e.jsx(y,{children:new Date(a.date).toLocaleDateString()}),e.jsxs(y,{children:["$",a.amount.toFixed(2)]}),e.jsx(y,{children:e.jsx(x,{variant:a.status==="paid"?"default":"destructive",children:a.status})}),e.jsx(y,{children:e.jsx(j,{variant:"ghost",size:"sm",children:e.jsx(X,{className:"h-4 w-4"})})})]},a.id))})]})})]})}function he({currentPlan:s,isVip:a}){const t=ee();if(a)return e.jsxs(n,{children:[e.jsxs(o,{children:[e.jsx(m,{children:"VIP Premium Access"}),e.jsx(v,{children:"You have unlimited access to all features"})]}),e.jsx(c,{children:e.jsxs("div",{className:"border-2 border-pale skin-500 rounded-lg p-6 bg-gradient-to-r from-pale skin-50 to-teal-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-bold text-2xl text-pale skin-900",children:"VIP Premium"}),e.jsx(x,{className:"bg-gradient-to-r from-pale skin-600 to-teal-600",children:"Special Access"})]}),e.jsxs("p",{className:"text-4xl font-bold mb-4 text-pale skin-900",children:["Free",e.jsx("span",{className:"text-sm text-gray-600",children:"/forever"})]}),e.jsxs("ul",{className:"space-y-2 mb-4",children:[e.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[e.jsx(h,{className:"h-4 w-4 text-pale skin-600"}),"Unlimited Products"]}),e.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[e.jsx(h,{className:"h-4 w-4 text-pale skin-600"}),"Unlimited Customers"]}),e.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[e.jsx(h,{className:"h-4 w-4 text-pale skin-600"}),"Unlimited Emails"]}),e.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[e.jsx(h,{className:"h-4 w-4 text-pale skin-600"}),"Unlimited Bookings"]}),e.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[e.jsx(h,{className:"h-4 w-4 text-pale skin-600"}),"All AI Tools & Features"]}),e.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[e.jsx(h,{className:"h-4 w-4 text-pale skin-600"}),"Priority Support"]})]}),e.jsx("p",{className:"text-sm text-gray-600 italic",children:"Thank you for being a valued member of our community!"})]})})]});const r=[{name:"Starter",price:9,features:["10 Products","100 Customers","500 Emails/mo","Basic Analytics"]},{name:"Pro",price:29,features:["100 Products","1000 Customers","5000 Emails/mo","Advanced Analytics","AI Tools"]},{name:"Enterprise",price:99,features:["Unlimited Products","Unlimited Customers","Unlimited Emails","Priority Support","Custom Features"]}];return e.jsxs(n,{children:[e.jsxs(o,{children:[e.jsx(m,{children:"Available Plans"}),e.jsx(v,{children:"Upgrade or downgrade your subscription"})]}),e.jsx(c,{children:e.jsx("div",{className:"grid md:grid-cols-3 gap-4",children:r.map(i=>e.jsxs("div",{className:"border rounded-lg p-4 relative",children:[s===i.name.toLowerCase()&&e.jsx(x,{className:"absolute top-2 right-2",children:"Current"}),e.jsx("h3",{className:"font-bold text-lg mb-2",children:i.name}),e.jsxs("p",{className:"text-3xl font-bold mb-4",children:["$",i.price,e.jsx("span",{className:"text-sm text-gray-500",children:"/mo"})]}),e.jsx("ul",{className:"space-y-2 mb-4",children:i.features.map(p=>e.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[e.jsx(h,{className:"h-4 w-4 text-green-600"}),p]},p))}),e.jsx(j,{className:"w-full",variant:s===i.name.toLowerCase()?"outline":"default",disabled:s===i.name.toLowerCase(),onClick:()=>t("/pricing"),children:s===i.name.toLowerCase()?"Current Plan":"Select Plan"})]},i.name))})})]})}function je(){const[s,a]=d.useState(!1),{toast:t}=H(),r={brand:"Visa",last4:"4242",expMonth:12,expYear:2025},i=async()=>{a(!0),setTimeout(()=>{t({title:"Payment method updated",description:"Your payment information has been updated successfully."}),a(!1)},1e3)};return e.jsxs(n,{children:[e.jsx(o,{children:e.jsx(m,{children:"Payment Method"})}),e.jsxs(c,{children:[e.jsx("div",{className:"flex items-center justify-between p-4 border rounded-lg mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(B,{className:"h-8 w-8 text-gray-400"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[r.brand," ending in ",r.last4]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Expires ",r.expMonth,"/",r.expYear]})]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{variant:"outline",className:"flex-1",onClick:i,disabled:s,children:"Update Card"}),e.jsxs(j,{variant:"outline",onClick:i,disabled:s,children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Add New"]})]})]})]})}function ge({trialEndDate:s,currentPlan:a}){const t=new Date,r=new Date(s),i=Math.ceil((r.getTime()-t.getTime())/(1e3*60*60*24)),p=Math.ceil((r.getTime()-t.getTime())/(1e3*60*60)),w=(14-i)/14*100,f=i<=3;return e.jsxs(n,{className:f?"border-red-500 bg-red-50":"border-blue-500 bg-blue-50",children:[e.jsxs(o,{children:[e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(A,{className:f?"text-red-600":"text-blue-600"}),a," Trial Active"]}),e.jsx(v,{children:i>0?`${i} ${i===1?"day":"days"} remaining (${p} hours)`:"Trial expires today!"})]}),e.jsxs(c,{className:"space-y-4",children:[e.jsx($,{value:w,className:"h-2"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Your trial ends on ",r.toLocaleDateString()," at ",r.toLocaleTimeString()]}),e.jsx(j,{asChild:!0,className:"w-full",variant:f?"destructive":"default",children:e.jsxs(ae,{to:"/pricing",children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"Upgrade Now to Keep Access"]})})]})]})}function fe({daysRemaining:s,variant:a="default",isVip:t}){if(t)return a==="compact"?e.jsxs(x,{className:"ml-2 bg-gradient-to-r from-pale skin-600 to-teal-600",children:[e.jsx(_,{className:"w-3 h-3 mr-1"}),"VIP"]}):e.jsxs(x,{className:"text-sm px-3 py-1 bg-gradient-to-r from-pale skin-600 to-teal-600",children:[e.jsx(_,{className:"w-4 h-4 mr-1.5"}),"VIP Premium"]});if(s!==void 0){const r=s<=3;return a==="compact"?e.jsxs(x,{variant:r?"destructive":"secondary",className:"ml-2",children:[e.jsx(A,{className:"w-3 h-3 mr-1"}),s,"d trial"]}):e.jsxs(x,{variant:r?"destructive":"secondary",className:"text-sm px-3 py-1",children:[e.jsx(A,{className:"w-4 h-4 mr-1.5"}),s," ",s===1?"day":"days"," left in trial"]})}return null}const Ne=ie,be=re,ye=le,z=d.forwardRef(({className:s,...a},t)=>e.jsx(R,{className:u("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a,ref:t}));z.displayName=R.displayName;const F=d.forwardRef(({className:s,...a},t)=>e.jsxs(ye,{children:[e.jsx(z,{}),e.jsx(E,{ref:t,className:u("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-card p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...a})]}));F.displayName=E.displayName;const q=({className:s,...a})=>e.jsx("div",{className:u("flex flex-col space-y-2 text-center sm:text-left",s),...a});q.displayName="AlertDialogHeader";const O=({className:s,...a})=>e.jsx("div",{className:u("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2 mt-4",s),...a});O.displayName="AlertDialogFooter";const K=d.forwardRef(({className:s,...a},t)=>e.jsx(V,{ref:t,className:u("text-lg font-semibold text-primary/90",s),...a}));K.displayName=V.displayName;const G=d.forwardRef(({className:s,...a},t)=>e.jsx(I,{ref:t,className:u("text-sm text-muted-foreground mt-2",s),...a}));G.displayName=I.displayName;const Z=d.forwardRef(({className:s,...a},t)=>e.jsx(M,{ref:t,className:u(Y(),s),...a}));Z.displayName=M.displayName;const J=d.forwardRef(({className:s,...a},t)=>e.jsx(L,{ref:t,className:u(Y({variant:"outline"}),"mt-2 sm:mt-0",s),...a}));J.displayName=L.displayName;function Ue(){const[s,a]=d.useState(null),[t,r]=d.useState(!0),{toast:i}=H();d.useEffect(()=>{p()},[]);const p=async()=>{try{const{data:{user:l}}=await C.auth.getUser();if(!l)return;const{data:g,error:N}=await C.from("subscriptions").select("*").eq("user_id",l.id).order("created_at",{ascending:!1}).limit(1).single();if(N&&N.code!=="PGRST116")throw N;a(g||{status:"none",product_id:"starter"})}catch(l){i({title:"Error loading subscription",description:l.message,variant:"destructive"})}finally{r(!1)}},w=async()=>{try{const{error:l}=await C.functions.invoke("cancel-subscription",{body:{subscriptionId:s.stripe_subscription_id}});if(l)throw l;i({title:"Subscription canceled",description:"Your subscription will remain active until the end of the billing period."}),p()}catch(l){i({title:"Error",description:l.message,variant:"destructive"})}},f=l=>{const g={active:{variant:"default",label:"Active"},canceled:{variant:"secondary",label:"Canceled"},past_due:{variant:"destructive",label:"Past Due"},none:{variant:"outline",label:"No Subscription"}},{variant:N,label:W}=g[l]||g.none;return e.jsx(x,{variant:N,children:W})};if(t)return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(U,{}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 py-8",children:e.jsx(n,{children:e.jsx(c,{className:"p-8 text-center",children:"Loading..."})})})]});const Q=()=>{if(!s?.trial_end_date)return 0;const l=new Date,g=new Date(s.trial_end_date);return Math.ceil((g.getTime()-l.getTime())/(1e3*60*60*24))};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(U,{}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Subscription Management"}),(s?.is_trial||s?.is_vip)&&e.jsx(fe,{daysRemaining:s?.is_trial?Q():void 0,isVip:s?.is_vip,variant:"compact"})]}),f(s?.status||"none")]}),s?.is_trial&&s?.trial_end_date&&e.jsx("div",{className:"mb-6",children:e.jsx(ge,{trialEndDate:s.trial_end_date,currentPlan:s.tier||"Pro"})}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6 mb-6",children:[e.jsxs(n,{children:[e.jsxs(o,{children:[e.jsx(m,{children:"Current Plan"}),e.jsx(v,{children:"Pro Plan"})]}),e.jsxs(c,{children:[e.jsxs("p",{className:"text-3xl font-bold mb-2",children:["$29",e.jsx("span",{className:"text-lg text-gray-500",children:"/mo"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-4",children:[e.jsx(P,{className:"h-4 w-4"}),"Next billing: ",s?.current_period_end?new Date(s.current_period_end).toLocaleDateString():"N/A"]}),e.jsxs(j,{className:"w-full",variant:"outline",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Upgrade Plan"]})]})]}),e.jsxs(n,{children:[e.jsx(o,{children:e.jsx(m,{children:"Billing Status"})}),e.jsxs(c,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s?.cancel_at_period_end?e.jsx(ce,{className:"h-8 w-8 text-orange-500"}):e.jsx(de,{className:"h-8 w-8 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:s?.cancel_at_period_end?"Canceling Soon":"Active & Current"}),e.jsx("p",{className:"text-sm text-gray-500",children:"All payments up to date"})]})]}),s?.status==="active"&&!s?.cancel_at_period_end&&e.jsxs(Ne,{children:[e.jsx(be,{asChild:!0,children:e.jsx(j,{variant:"destructive",className:"w-full",children:"Cancel Subscription"})}),e.jsxs(F,{children:[e.jsxs(q,{children:[e.jsx(K,{children:"Are you sure?"}),e.jsx(G,{children:"Your subscription will remain active until the end of your billing period. You can reactivate anytime before then."})]}),e.jsxs(O,{children:[e.jsx(J,{children:"Keep Subscription"}),e.jsx(Z,{onClick:w,children:"Cancel Subscription"})]})]})]})]})]}),e.jsxs(n,{children:[e.jsx(o,{children:e.jsx(m,{children:"Total Spent"})}),e.jsxs(c,{children:[e.jsx("p",{className:"text-3xl font-bold mb-2",children:"$116.00"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"4 months subscribed"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(B,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:"Visa ending in 4242"})]})]})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6 mb-6",children:[e.jsx(ue,{planTier:"pro"}),e.jsx(je,{})]}),e.jsx("div",{className:"mb-6",children:e.jsx(he,{currentPlan:"pro",isVip:s?.is_vip})}),e.jsx(pe,{})]})]})}export{Ue as default};
//# sourceMappingURL=Subscriptions-Dhr66WFU.js.map
