import{r as t,j as e}from"./react-vendor-zXfd7Ve7.js";import{h as D,s as n,b as m,B as u,C as d,c as l,a as j,L as c,I as g,T as S}from"./index-k1V3dZSG.js";import{S as L,a as q,b as B,c as T,d as f}from"./select-C3Vw_1bu.js";import{B as I}from"./badge-wcb6nnAT.js";import{D as E}from"./DashboardNav-dXlKSIlC.js";import"./vendor-BOHFvtXa.js";import"./ui-vendor-BrpyYz2q.js";import"./supabase-CH0YqYdn.js";function O(){const{user:i}=D(),[x,C]=t.useState([]),[v,y]=t.useState([]),[w,N]=t.useState(!0),[o,p]=t.useState(!1),[a,r]=t.useState({name:"",goal:"",keyword:"",product_id:""});t.useEffect(()=>{h()},[i]);const h=async()=>{if(!i)return;const{data:s}=await n.from("shops").select("id").eq("user_id",i.id).single();if(s){const{data:_}=await n.from("dm_campaigns").select("*, products(name)").eq("shop_id",s.id).order("created_at",{ascending:!1});C(_||[]);const{data:k}=await n.from("products").select("*").eq("shop_id",s.id);y(k||[])}N(!1)},b=async()=>{if(!a.name||!a.keyword){alert("Please fill in campaign name and keyword");return}const{data:s}=await n.from("shops").select("id").eq("user_id",i?.id).single();s&&(await n.from("dm_campaigns").insert({shop_id:s.id,name:a.name,goal:a.goal,keyword:a.keyword.toUpperCase(),product_id:a.product_id||null,dm_sequence:[{order:1,message:`Thanks for your interest! Here's the link to ${a.name}`}],suggested_caption:`Comment "${a.keyword.toUpperCase()}" below to get instant access!`}),r({name:"",goal:"",keyword:"",product_id:""}),p(!1),h())};return e.jsxs("div",{className:"flex min-h-screen bg-slate-50",children:[e.jsx(E,{}),e.jsx("div",{className:"flex-1 p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx(m,{className:"text-3xl",children:"DM Campaigns"}),e.jsx(u,{onClick:()=>p(!o),children:o?"Cancel":"Create Campaign"})]}),e.jsx(d,{className:"bg-blue-50 border-blue-200 mb-6",children:e.jsx(l,{className:"p-4",children:e.jsxs("p",{className:"text-blue-900 text-sm",children:[e.jsx("strong",{children:"Note:"})," Live Instagram automation requires connecting your Instagram business account. For now, you can create campaigns and copy the scripts manually."]})})}),o&&e.jsxs(d,{className:"mb-6",children:[e.jsx(j,{children:e.jsx(m,{children:"Create DM Campaign"})}),e.jsx(l,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(c,{children:"Campaign Name"}),e.jsx(g,{type:"text",value:a.name,onChange:s=>r({...a,name:s.target.value}),placeholder:"e.g., Budget Course Promo"})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Keyword"}),e.jsx(g,{type:"text",value:a.keyword,onChange:s=>r({...a,keyword:s.target.value}),placeholder:"e.g., BUDGET"})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Link to Product (Optional)"}),e.jsxs(L,{value:a.product_id,onValueChange:s=>r({...a,product_id:s}),children:[e.jsx(q,{children:e.jsx(B,{placeholder:"None"})}),e.jsxs(T,{children:[e.jsx(f,{value:"",children:"None"}),v.map(s=>e.jsx(f,{value:s.id,children:s.name},s.id))]})]})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Goal (Optional)"}),e.jsx(S,{value:a.goal,onChange:s=>r({...a,goal:s.target.value}),placeholder:"What do you want to achieve with this campaign?"})]}),e.jsx(u,{onClick:b,children:"Create Campaign"})]})})]}),w?e.jsx("p",{className:"text-slate-600",children:"Loading campaigns..."}):x.length===0?e.jsx(d,{children:e.jsx(l,{className:"p-12 text-center",children:e.jsx("p",{className:"text-slate-600",children:"No DM campaigns yet. Create one to get started!"})})}):e.jsx("div",{className:"space-y-4",children:x.map(s=>e.jsxs(d,{children:[e.jsx(j,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(m,{children:s.name}),e.jsxs("p",{className:"text-sm text-slate-600 mt-1",children:["Keyword: ",e.jsx("strong",{children:s.keyword})]}),s.products&&e.jsxs("p",{className:"text-sm text-slate-600",children:["Linked to: ",s.products.name]})]}),e.jsx(I,{variant:s.active?"default":"secondary",children:s.active?"Active":"Draft"})]})}),s.suggested_caption&&e.jsx(l,{children:e.jsxs("div",{className:"p-3 bg-pale skin-50 rounded",children:[e.jsx("p",{className:"text-sm font-medium text-pale skin-900 mb-1",children:"Suggested Caption:"}),e.jsx("p",{className:"text-sm text-pale skin-700",children:s.suggested_caption})]})})]},s.id))})]})})]})}export{O as default};
//# sourceMappingURL=DMCampaigns-8IPPNweA.js.map
