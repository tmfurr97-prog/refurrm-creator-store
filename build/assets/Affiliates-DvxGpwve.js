import{r as c,j as e,aV as M,a5 as V,m as D,X as z,ag as E,G as k,aW as W,a8 as B,aX as $}from"./react-vendor-zXfd7Ve7.js";import{T as J,a as X,b as w,c as b}from"./tabs-jniJqZuw.js";import{u as P,s as y,C as j,a as f,b as p,B as m,I as T,c as g,d as _,L as A}from"./index-D8webL0o.js";import{T as F,a as H,b as d,c as r,d as I,e as i}from"./table-nE7UOO90.js";import{B as U}from"./badge-C_-9dwWz.js";import{S as G,a as O,b as Y,c as q,d as L}from"./select-BG5THQer.js";import{S as K}from"./switch-CMyH0-Ke.js";import"./vendor-BOHFvtXa.js";import"./ui-vendor-BrpyYz2q.js";import"./supabase-CH0YqYdn.js";function Q(){const[l,t]=c.useState(""),[x,h]=c.useState([]),[u,a]=c.useState(!0),{toast:n}=P();c.useEffect(()=>{v()},[]);const v=async()=>{try{const{data:s,error:o}=await y.from("affiliates").select("*").order("created_at",{ascending:!1});if(o)throw o;h(s||[])}catch(s){n({title:"Error",description:s.message,variant:"destructive"})}finally{a(!1)}},N=async(s,o)=>{try{const{data:{user:S}}=await y.auth.getUser(),{error:R}=await y.functions.invoke("approve-affiliate",{body:{affiliateId:s,approved:o,adminUserId:S?.id}});if(R)throw R;n({title:o?"Affiliate Approved":"Affiliate Rejected",description:o?"Welcome email sent to affiliate":"Application rejected"}),v()}catch(S){n({title:"Error",description:S.message,variant:"destructive"})}},C=x.filter(s=>s.name?.toLowerCase().includes(l.toLowerCase())||s.email?.toLowerCase().includes(l.toLowerCase()));return e.jsxs(j,{children:[e.jsxs(f,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(p,{children:"Affiliates"}),e.jsxs(m,{onClick:()=>window.location.href="/affiliate-signup",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Invite Affiliate"]})]}),e.jsxs("div",{className:"relative mt-4",children:[e.jsx(V,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(T,{placeholder:"Search affiliates...",value:l,onChange:s=>t(s.target.value),className:"pl-10"})]})]}),e.jsx(g,{children:e.jsxs(F,{children:[e.jsx(H,{children:e.jsxs(d,{children:[e.jsx(r,{children:"Name"}),e.jsx(r,{children:"Email"}),e.jsx(r,{children:"Code"}),e.jsx(r,{children:"Status"}),e.jsx(r,{children:"Actions"})]})}),e.jsx(I,{children:u?e.jsx(d,{children:e.jsx(i,{colSpan:5,className:"text-center",children:"Loading..."})}):C.length===0?e.jsx(d,{children:e.jsx(i,{colSpan:5,className:"text-center",children:"No affiliates found"})}):C.map(s=>e.jsxs(d,{children:[e.jsx(i,{className:"font-medium",children:s.name}),e.jsx(i,{children:s.email}),e.jsx(i,{className:"font-mono text-sm",children:s.affiliate_code}),e.jsx(i,{children:e.jsx(U,{variant:s.status==="active"?"default":s.status==="pending"?"secondary":"destructive",children:s.status})}),e.jsx(i,{children:s.status==="pending"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{size:"sm",onClick:()=>N(s.id,!0),children:e.jsx(D,{className:"w-4 h-4"})}),e.jsx(m,{size:"sm",variant:"destructive",onClick:()=>N(s.id,!1),children:e.jsx(z,{className:"w-4 h-4"})})]})})]},s.id))})]})})]})}function Z(){const l=[{label:"Active Affiliates",value:"24",icon:E,change:"+3 this month"},{label:"Total Sales",value:"$12,450",icon:k,change:"+18% from last month"},{label:"Clicks",value:"3,842",icon:W,change:"+12% from last month"},{label:"Conversion Rate",value:"4.2%",icon:B,change:"+0.8% from last month"}];return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:l.map(t=>e.jsxs(j,{children:[e.jsxs(f,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(p,{className:"text-sm font-medium",children:t.label}),e.jsx(t.icon,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(g,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t.value}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:t.change})]})]},t.label))})}function ee(){const[l,t]=c.useState("20"),[x,h]=c.useState("percentage"),[u,a]=c.useState("30"),[n,v]=c.useState(!1),{toast:N}=P(),C=()=>{N({title:"Settings saved",description:"Your commission settings have been updated."})};return e.jsxs(j,{children:[e.jsxs(f,{children:[e.jsx(p,{children:"Commission Settings"}),e.jsx(_,{children:"Configure how affiliates earn commissions"})]}),e.jsxs(g,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"commissionRate",children:"Commission Rate"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(T,{id:"commissionRate",type:"number",value:l,onChange:s=>t(s.target.value),className:"max-w-[200px]"}),e.jsxs(G,{value:x,onValueChange:h,children:[e.jsx(O,{className:"max-w-[150px]",children:e.jsx(Y,{})}),e.jsxs(q,{children:[e.jsx(L,{value:"percentage",children:"Percentage"}),e.jsx(L,{value:"fixed",children:"Fixed Amount"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"cookieDuration",children:"Cookie Duration (days)"}),e.jsx(T,{id:"cookieDuration",type:"number",value:u,onChange:s=>a(s.target.value),className:"max-w-[200px]"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"How long to track referrals"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(A,{children:"Auto-approve Affiliates"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically approve new affiliate applications"})]}),e.jsx(K,{checked:n,onCheckedChange:v})]}),e.jsx(m,{onClick:C,children:"Save Settings"})]})]})}function se(){const{toast:l}=P(),[t,x]=c.useState([{id:1,affiliate:"Sarah Johnson",amount:890.5,status:"pending",date:"2024-01-15"},{id:2,affiliate:"Mike Chen",amount:640,status:"pending",date:"2024-01-15"},{id:3,affiliate:"Emma Davis",amount:560,status:"paid",date:"2024-01-01"},{id:4,affiliate:"James Wilson",amount:380,status:"paid",date:"2024-01-01"}]),h=a=>{x(t.map(n=>n.id===a?{...n,status:"paid"}:n)),l({title:"Payout processed",description:"The affiliate has been paid."})},u=t.filter(a=>a.status==="pending").reduce((a,n)=>a+n.amount,0);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(j,{children:[e.jsx(f,{children:e.jsx(p,{children:"Pending Payouts"})}),e.jsxs(g,{children:[e.jsxs("div",{className:"text-3xl font-bold mb-4",children:["$",u.toFixed(2)]}),e.jsxs(m,{children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Process All Payouts"]})]})]}),e.jsxs(j,{children:[e.jsx(f,{children:e.jsx(p,{children:"Payout History"})}),e.jsx(g,{children:e.jsxs(F,{children:[e.jsx(H,{children:e.jsxs(d,{children:[e.jsx(r,{children:"Affiliate"}),e.jsx(r,{children:"Amount"}),e.jsx(r,{children:"Date"}),e.jsx(r,{children:"Status"}),e.jsx(r,{children:"Action"})]})}),e.jsx(I,{children:t.map(a=>e.jsxs(d,{children:[e.jsx(i,{className:"font-medium",children:a.affiliate}),e.jsxs(i,{children:["$",a.amount.toFixed(2)]}),e.jsx(i,{children:a.date}),e.jsx(i,{children:e.jsx(U,{variant:a.status==="paid"?"default":"secondary",children:a.status})}),e.jsx(i,{children:a.status==="pending"&&e.jsxs(m,{size:"sm",onClick:()=>h(a.id),children:[e.jsx(D,{className:"w-4 h-4 mr-1"}),"Pay"]})})]},a.id))})]})})]})]})}function xe(){const[l,t]=c.useState(20);return e.jsxs("div",{className:"container mx-auto p-6 max-w-7xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Affiliate Program"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your affiliates, track sales, and process payouts"})]}),e.jsxs(J,{defaultValue:"overview",className:"space-y-6",children:[e.jsxs(X,{children:[e.jsxs(w,{value:"overview",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Overview"]}),e.jsxs(w,{value:"affiliates",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Affiliates"]}),e.jsxs(w,{value:"payouts",children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Payouts"]}),e.jsxs(w,{value:"settings",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Settings"]})]}),e.jsx(b,{value:"overview",children:e.jsx(Z,{})}),e.jsx(b,{value:"affiliates",children:e.jsx(Q,{})}),e.jsx(b,{value:"payouts",children:e.jsx(se,{})}),e.jsx(b,{value:"settings",children:e.jsx(ee,{})})]})]})}export{xe as default};
//# sourceMappingURL=Affiliates-DvxGpwve.js.map
